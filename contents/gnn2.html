<!DOCTYPE html>
<html>
    <head>
        <title>Cora 데이터와 GCN을 이용한 노드 분류</title>
        <meta name="description" content="GCN을 이용하여 노드의 카테고리를 예측합니다.">
        <meta charset="utf-8">
        <link rel="stylesheet" href="init/index.css">
        <link rel="stylesheet" href="init/contents.css">
        <link rel="stylesheet" href="init/index_img/icons/css/fontello.css">

        <link rel="preconnect" href="https://fonts.googleapis.com"> 
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
        <link href="https://fonts.googleapis.com/css2?family=Dongle:wght@300&display=swap" rel="stylesheet">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang&display=swap" rel="stylesheet">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap" rel="stylesheet">

        <link rel="stylesheet"
            href="init/highlight/styles/github-dark.min.css">
        <script src="init/highlight/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
        <script src="init/highlight/highlights_line.js"></script>
        <script>initNumber(window, document);</script>
        <script>hljs.initLineNumbersOnLoad();</script>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="init/index.js"></script>
        <script src="init/jquery.pjax.js"></script>
        
        <meta name="viewport" content="width=device-width, initial-scale=0.8, max-width=1">

        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-219110982-1"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-219110982-1');
        </script>
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7745178886614102"
        crossorigin="anonymous"></script>

        <meta property="og:url" content="https://ljm565.github.io/contents/gnn2.html" />
        <meta property="og:title" content="Cora 데이터와 GCN을 이용한 노드 분류" />
        <meta property="og:type" content="website">
        <meta property="og:description" content="GCN을 이용하여 노드의 카테고리를 예측합니다." />
        <meta property="og:image" content="https://lh3.googleusercontent.com/fife/ALs6j_EiXg856tl-UUdNbHNXG838z4ZFH-5RDf7fi_rGUQNTuqxqmijYhdNO_jc6PpDc-I1-E_o8MLbQ7XWY7Dd6FuaZafumzaiDW0Vz60R6qhJQl6-dyywrNS3UZ62s8g4eikRGjeUQB7xqHy_CUUkrNrnH6ShRaJE8Yw1hjSBjdYzcaoXCmAgkiBnfCmz_PpfoXYc2zqMdsJBfWVXpbFEHPcVFwGl_RQVAIc4GPNMTlwvsZ4dKN-k0veJfj4h1aJ6Wr-BJxHbpInDSRzhrXajoJ96I75ASuL7xCHPH0h7DapZ--DrjqF5LEJdZfiNItxxbjcRorIm_N5akg5uZWbkFAzMUITipKzYuDb0oSg30JP9EkF0odUgoBF2i4D0dQpeDkhaqs3MDZi3rhCBjXGSo5i7HwVSY0sCI02rh4TIDxrJbvuTz01Wo6_RTZDHZjqE40V27uKj7VqfPYpq0Ia9SGxQrGrVvB-oqKiLgBs7JEqtbMoBApA_ZdFPIhkITrcGweEbFE9jHVIVeh3IDrfz3aZbVd0NljwIxWgv9FkHZikvoNGuk8dJOHkZoK7ZDiMqd15HeuCTEzvFfQhkOlN6wV1wNBjskd1s55ulztDRRNvS-LLC3CZGVM0Hh0e2NCbLXnokZMDs4h6zA_pD2ZKK6d8OBUSgrDB2EnDW242-3j63UvRaeSkF_P8J6RNxc9-9n58ftuic2VO1twlSjCM1kENaP9cQg40sTeLAuW76l65si2_ofE-rQlwmrz4DYmV0Pb4Ju2Zz8owLXtiaCVCCGO_Ly3YVjI_e6ARAVy6lm6KGlJtIro1GzMnXusj6Zko_sSpR72dViC0td9dZrYORY4_QOeRIrMlw9gAyIIYgsJucd5oiF_RQepKlT1BK_XHKdcoWu07pL0uflTdyDh-zqFrERXGBTpQCrn4YIk8pz0GzCbyEDBPyzsN5Ba_rnnzCJjiqd_pYxziliaGDFEWSB1-RSrccp2s9K2oqFauEADqtn6tMNzjh99Z3zOrhheDKKc-X2LHi0cQ3m6NVXJIRcpmGZq3qkhRgiR9ekaGFYcihse59BZCx0lSN4RTQdDhZzon9xjyL3nKelE4NcN4mfPazAuNtmikmNJULhcr20o7iy5pd7i-4XADzZyx95tnSwmEej6ATBxW7FG1QS287msyu7LgVthbuVkpn4HsescCIXE6iXPZL0GgDCeipoPFL1ckIhamoJA-oDs_TCyoaXzIvzKvqn_YWeqvg-tXPDk83-_XHa6IYF3awmern3JUJIj_6_dxoTDGsqowPpjLI8qGmHHgSV6vq_784TQ_GO6a_1wKyqzRlFpan8X7S2fjsBKhij6hP5LItkQi0FFXoVNxEtI9LVCVcclx4f8_UxPGRvJEwnAT-45Lu-vTaA-YddyVU4kOY-ueA9gEZseCMr1CNZJbyoIKbz_EUDROYj3JfT0G9WatTrOJFN0GS0XMCJEPBZNKrvz74jWpzuyp2hIEMrkgHzV-W_q5xlMD4YJx4ZoOhoylQuPm_UvIVYrPSxSp9DKSlVCg" />
    </head>   
    <body>
        <div id="modeButton">
            <button type="button" value="dark" onclick="darkMode(this)" onmouseover="hoveringOn(this)" onmouseout="hoveringOff(this)">
                <div class="modeImg"><img id="modeImg" src="init/index_img/moon_off.png"></div>
                <div id="modeState">다크 모드로 보기</div>
            </button>
        </div>

        <div id="container" onclick="reload();">
            <article>
                <script src="init/highlight/highlight.min.js"></script>
                <script>hljs.highlightAll();</script>
                <script src="init/highlight/highlights_line.js"></script>
                <script>initNumber(window, document);</script>
                <script>hljs.initLineNumbersOnLoad();</script>
                <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
                <script>
                    initMathJax();
                </script>
                <div id="mainHeadWrapper">
                    <div id="mainHead">
                        <h1 class="contentHead">딥러닝 이야기 / Graph Neural Network (GNN), Graph Convolutional Network (GCN) / 2. Cora 데이터와 GCN을 이용한 노드 분류</h1>
                    </div>
                </div>
                
                <div class="title" style="background-image:url(https://lh3.googleusercontent.com/fife/ALs6j_EiXg856tl-UUdNbHNXG838z4ZFH-5RDf7fi_rGUQNTuqxqmijYhdNO_jc6PpDc-I1-E_o8MLbQ7XWY7Dd6FuaZafumzaiDW0Vz60R6qhJQl6-dyywrNS3UZ62s8g4eikRGjeUQB7xqHy_CUUkrNrnH6ShRaJE8Yw1hjSBjdYzcaoXCmAgkiBnfCmz_PpfoXYc2zqMdsJBfWVXpbFEHPcVFwGl_RQVAIc4GPNMTlwvsZ4dKN-k0veJfj4h1aJ6Wr-BJxHbpInDSRzhrXajoJ96I75ASuL7xCHPH0h7DapZ--DrjqF5LEJdZfiNItxxbjcRorIm_N5akg5uZWbkFAzMUITipKzYuDb0oSg30JP9EkF0odUgoBF2i4D0dQpeDkhaqs3MDZi3rhCBjXGSo5i7HwVSY0sCI02rh4TIDxrJbvuTz01Wo6_RTZDHZjqE40V27uKj7VqfPYpq0Ia9SGxQrGrVvB-oqKiLgBs7JEqtbMoBApA_ZdFPIhkITrcGweEbFE9jHVIVeh3IDrfz3aZbVd0NljwIxWgv9FkHZikvoNGuk8dJOHkZoK7ZDiMqd15HeuCTEzvFfQhkOlN6wV1wNBjskd1s55ulztDRRNvS-LLC3CZGVM0Hh0e2NCbLXnokZMDs4h6zA_pD2ZKK6d8OBUSgrDB2EnDW242-3j63UvRaeSkF_P8J6RNxc9-9n58ftuic2VO1twlSjCM1kENaP9cQg40sTeLAuW76l65si2_ofE-rQlwmrz4DYmV0Pb4Ju2Zz8owLXtiaCVCCGO_Ly3YVjI_e6ARAVy6lm6KGlJtIro1GzMnXusj6Zko_sSpR72dViC0td9dZrYORY4_QOeRIrMlw9gAyIIYgsJucd5oiF_RQepKlT1BK_XHKdcoWu07pL0uflTdyDh-zqFrERXGBTpQCrn4YIk8pz0GzCbyEDBPyzsN5Ba_rnnzCJjiqd_pYxziliaGDFEWSB1-RSrccp2s9K2oqFauEADqtn6tMNzjh99Z3zOrhheDKKc-X2LHi0cQ3m6NVXJIRcpmGZq3qkhRgiR9ekaGFYcihse59BZCx0lSN4RTQdDhZzon9xjyL3nKelE4NcN4mfPazAuNtmikmNJULhcr20o7iy5pd7i-4XADzZyx95tnSwmEej6ATBxW7FG1QS287msyu7LgVthbuVkpn4HsescCIXE6iXPZL0GgDCeipoPFL1ckIhamoJA-oDs_TCyoaXzIvzKvqn_YWeqvg-tXPDk83-_XHa6IYF3awmern3JUJIj_6_dxoTDGsqowPpjLI8qGmHHgSV6vq_784TQ_GO6a_1wKyqzRlFpan8X7S2fjsBKhij6hP5LItkQi0FFXoVNxEtI9LVCVcclx4f8_UxPGRvJEwnAT-45Lu-vTaA-YddyVU4kOY-ueA9gEZseCMr1CNZJbyoIKbz_EUDROYj3JfT0G9WatTrOJFN0GS0XMCJEPBZNKrvz74jWpzuyp2hIEMrkgHzV-W_q5xlMD4YJx4ZoOhoylQuPm_UvIVYrPSxSp9DKSlVCg);">
                    <div>
                        <span class="mainTitle">Cora 데이터와 GCN을 이용한 노드 분류</span>
                        <br><br>
                        <div style="display: table-cell; margin: 0;">
                            <img src="init/index_img/profile.png" style="width: 30px; cursor: pointer;" onclick="pjaxPage('/');">
                        </div>
                        <span class="subTitle" style="display: table-cell; text-align: left; vertical-align: middle; padding-left: 20px; line-height: 125%;">작성자: 여행 초짜<br>작성일: 2023.02.12</span>
                    </div>
                </div>

                <div id="content">
                    <p>
                        시작하기 앞서 틀린 부분이 있을 수 있으니, 틀린 부분이 있다면 지적해주시면 감사하겠습니다.
                        
                        <br><br>이전글에서는 Graph Neural Network (GNN), Graph Convolutional Network (GCN)에 대해 살펴봤습니다.
                        <span class="highlight" style="color: rgb(0, 3, 206);">이번글에서는 GCN을 PyTorch Geometric, Deep Graph Library 등을 사용하지 않고 naive하게 PyTorch만을 이용하여 학습하는 코드를 구성해보겠습니다.</span>
                        이렇게 하는 이유는 본 코드에서 사용할 Cora 데이터가 batch 학습을 하지 해야할만큼 큰 데이터가 아니기 때문입니다.
                        대신 다음글인 <a onclick="pjaxPage('gnn3.html');"><span class="highlight" style="color: rgb(0, 3, 206);">GCN을 이용한 COLLAB TUDataset 그래프 분류</span></a>에서는 PyTorch Geometric으로 batch 학습을 하는 코드가 있으니 PyTorch Geometric의 코드를 살펴보고싶다면 다음글을 참고하시기 바랍니다.

                        <br><br>학습에 사용한 데이터는 Cora 그래프 데이터를 사용하였습니다.
                        데이터에 대한 설명은 아래와 같습니다.
                        <ul>
                            <li><b>개요</b>: Cora 그래프 데이터는 논문들의 인용 현황을 그래프로 나타낸 데이터입니다.</li>
                            <li><b>Node</b>: <span class="highlight" style="color: rgb(0, 3, 206);">그래프의 node는 하나의 논문을 의미합니다.</span></li>
                            <li><b>Edge</b>: <span class="highlight" style="color: rgb(0, 3, 206);">Node끼리 연결된 edge는 논문끼리의 인용 현황을 의미합니다.</span></li>
                            <li><b>Label</b>: Node별로 label이 부여되며, label은 논문의 카테고리를 의미합니다.</li>
                            <li><b>Node feature</b>: 학습에 사용할 node feature는 각 노드, 즉 논문이 포함된 단어여부를 나타내는 데이터입니다.
                                <span class="highlight" style="color: rgb(0, 3, 206);">예를 들어 5개의 단어 집합 중 하나의 node가 1, 2, 4의 단어가 포함되어있다면 이 node의 feature는 [1, 1, 0, 1, 0]이 됩니다.</span>
                            </li>
                        </ul>
                        <span class="highlight" style="color: rgb(0, 3, 206);">본 코드는 각 node의 label의 일부가 없다고 가정하고 일부 node의 label을 예측하는 코드입니다.</span>
                        그리고 마지막으로 GCN으로 학습된 각 node들의 feature를 t-SNE로 가시화합니다.
                        
                        <br><br><br><br>오늘의 컨텐츠입니다.
                        <ol>
                            <li>학습을 위한 데이터 구성</li>
                            <li>GCN 모델 구성</li>
                            <li>GCN 학습</li>
                            <li>학습 결과 및 특징 가시화</li>
                        </ol>
                    </p>
                    <div class="link">
                        <a href="https://github.com/ljm565/paper-category-prediction-GCN" target="_blank" onmouseover="colorOn(this);" onmouseout="colorOff(this);">Cora 데이터 노드 분류 GitHub 코드</a>
                    </div>


                    <h1 class="subHead">Node 분류를 위한 GCN 학습</h1>
                    <div class="doubleSubHead">
                        <span style="display: block; text-align: center;">&ldquo;</span>
                        <span>학습을 위한 데이터 구성</span><br>
                        <span style="display: block; text-align: center; margin-top: 13px;">&rdquo;</span>
                    </div>
                    <p>
                        아래 코드는 graph node, edge 데이터와 node feature를 받아 adjacency matrix와 학습에 사용할 feature, label을 구성하는 코드입니다.
                    </p>
<pre><code class="python"><span class="reserved">def</span> <span class="method">load_data</span>(<span class="var">cite_data_path</span>, <span class="var">content_data_path</span>):
    <span class="annot"># load edge information</span>
    <span class="var">cites</span> = <span class="clazz">pd</span>.<span class="method">read_csv</span>(<span class="var">cite_data_path</span>, <span class="var">sep</span>=<span class="str">'\t'</span>, <span class="var">header</span>=<span class="reserved">None</span>, <span class="var">names</span>=[<span class="str">'target'</span>, <span class="str">'source'</span>])
    
    <span class="annot"># load node feature, the last column is label</span>
    <span class="var">col</span> = [<span class="str">'word_{}'</span>.<span class="method">format</span>(<span class="var">i</span>) <span class="return">for</span> <span class="var">i</span> <span class="return">in</span> <span class="return">range</span>(<span class="num">1433</span>)] + ['<span class="var">category</span>']  <span class="annot"># 1433 is the number of words in dict and final category</span>
    <span class="var">contents</span> = <span class="clazz">pd</span>.<span class="method">read_csv</span>(<span class="var">content_data_path</span>, <span class="var">delimiter</span>=<span class="str">'\t'</span>, <span class="var">header</span>=<span class="reserved">None</span>, <span class="var">names</span>=<span class="var">col</span>)

    <span class="annot"># make label and node location dictionaries</span>
    <span class="var">category</span> = {<span class="var">c</span>: <span class="var">i</span> <span class="return">for</span> <span class="var">i</span>, <span class="var">c</span> <span class="return">in</span> <span class="clazz">enumerate</span>(<span class="method">sorted</span>(<span class="clazz">list</span>(<span class="clazz">set</span>(<span class="var">contents</span>['<span class="var">category</span>']))))}   <span class="annot"># sort: for reproduction</span>
    <span class="var">node_loc</span> = {<span class="var">n</span>: <span class="var">i</span> <span class="return">for</span> <span class="var">i</span>, <span class="var">n</span> <span class="return">in</span> <span class="clazz">enumerate</span>(<span class="clazz">list</span>(<span class="var">contents</span>.<span class="var">index</span>))}

    <span class="return">return</span> <span class="var">cites</span>, <span class="var">contents</span>, <span class="var">category</span>, <span class="var">node_loc</span>


<span class="reserved">def</span> <span class="method">make_gnn_data</span>(<span class="var">cite_data_path</span>, <span class="var">content_data_path</span>, <span class="var">dynamic</span>=<span class="reserved">True</span>, <span class="var">directed</span>=<span class="reserved">False</span>):
    <span class="var">cites</span>, <span class="var">contents</span>, <span class="var">category</span>, <span class="var">node_loc</span> = <span class="method">load_data</span>(<span class="var">cite_data_path</span>, <span class="var">content_data_path</span>)
    
    <span class="annot"># adjacency matrix</span>
    <span class="var">data_len</span> = <span class="method">len</span>(<span class="var">contents</span>)
    <span class="var">adj</span> = <span class="clazz">torch</span>.<span class="method">zeros</span>((<span class="var">data_len</span>, <span class="var">data_len</span>))
    <span class="var">adj</span>.<span class="method">fill_diagonal_</span>(<span class="num">1</span>)
    <span class="return">for</span> <span class="var">row</span> <span class="return">in</span> <span class="clazz">torch</span>.<span class="method">item</span>(<span class="var">cites</span>.<span class="var">values</span>):
        <span class="var">x</span>, <span class="var">y</span> = <span class="var">row</span>[<span class="num">0</span>].<span class="method">item</span>(), <span class="var">row</span>[<span class="num">1</span>].<span class="method">item</span>()
        <span class="return">if</span> <span class="var">directed</span> == <span class="reserved">False</span>:
            <span class="var">adj</span>[<span class="var">node_loc</span>[<span class="var">x</span>], <span class="var">node_loc</span>[<span class="var">y</span>]] = <span class="num">1</span>
        <span class="var">adj</span>[<span class="var">node_loc</span>[<span class="var">y</span>], <span class="var">node_loc</span>[<span class="var">x</span>]] = <span class="num">1</span>
    <span class="var">adj</span> = <span class="method">matrix_normalize</span>(<span class="var">adj</span>, <span class="var">dynamic</span>)

    <span class="annot"># feature matrix</span>
    <span class="var">feature</span> = <span class="method">matrix_normalize</span>(<span class="clazz">torch</span>.<span class="clazz">FloatTensor</span>(<span class="var">contents</span>.<span class="var">iloc</span>[:, :<span class="num">-1</span>].<span class="var">values</span>), <span class="var">dynamic</span>=<span class="reserved">False</span>)

    <span class="annot"># label matrix</span>
    <span class="var">label</span> = <span class="clazz">torch</span>.<span class="clazz">LongTensor</span>([<span class="var">category</span>[<span class="var">c</span>] <span class="return">for</span> <span class="var">c</span> <span class="return">in</span> <span class="var">contents</span>.<span class="var">iloc</span>[:, <span class="num">-1</span>]])

    <span class="return">return</span> <span class="var">adj</span>, <span class="var">feature</span>, <span class="var">label</span>


<span class="reserved">def</span> <span class="method">matrix_normalize</span>(<span class="var">x</span>, <span class="var">dynamic</span>):
    <span class="str">"""
    dynamic True: D^-0.5 A D^-0.5
    dynamic False: D^-1 A
    """</span>
    <span class="return">if</span> <span class="var">dynamic</span>:
        <span class="var">degree</span> = <span class="clazz">torch</span>.<span class="method">sum</span>(<span class="var">x</span>, <span class="var">dim</span>=1)
        <span class="var">D_inv</span> = <span class="clazz">torch</span>.<span class="clazz">FloatTensor</span>(<span class="method">fractional_matrix_power</span>(<span class="clazz">torch</span>.<span class="method">diag</span>(<span class="var">degree</span>), <span class="num">-0.5</span>))
        <span class="var">x</span> = <span class="clazz">torch</span>.<span class="method">mm</span>(<span class="clazz">torch</span>.<span class="method">mm</span>(<span class="var">D_inv</span>, <span class="var">x</span>), <span class="var">D_inv</span>)
    <span class="return">else</span>:
        <span class="var">degree</span> = <span class="clazz">torch</span>.<span class="method">sum</span>(<span class="var">x</span>, <span class="var">dim</span>=<span class="var">1</span>)
        <span class="var">D_inv</span> = <span class="clazz">torch</span>.<span class="clazz">linalg</span>.<span class="var">inv</span>(<span class="clazz">torch</span>.<span class="method">diag</span>(<span class="var">degree</span>))
        <span class="var">x</span> = <span class="clazz">torch</span>.<span class="method">mm</span>(<span class="var">D_inv</span>, <span class="var">x</span>)
    <span class="return">return</span> <span class="var">x</span>
</code></pre>
                    <p>
                        <ul>
                            <li>1 ~ 13번째 줄: cite라는 node, edge 그래프 데이터와 content라는 node feature, label 데이터를 구성하는 코드.</li>
                            <li>3번째 줄: cite라는 node, edge 그래프 데이터를 pandas로 구성.</li>
                            <li>6 ~ 7번째 줄: <span class="highlight" style="color: rgb(0, 3, 206);">1433개의 단어 집합 중 단어가 포함되어있는지 여부를 나타내는 node featur와 맨 마지막 column의 label 데이터를 pandas로 구성.</span></li>
                            <li>10번째 줄: Label을 숫자로 구성하는 부분.</li>
                            <li>11번째 줄: <span class="highlight" style="color: rgb(0, 3, 206);">Adjacency matrix 등을 구성할 때 row (or column) 중 특정 node의 위치를 정해주는 부분.</span></li>
                            <li>16 ~ 36번째 줄: 학습에 사용할 코드를 구성하는 부분.</li>
                            <li>19 ~ 27번째 줄: <span class="highlight" style="color: rgb(0, 3, 206);">논문은 인용과 피인용이 존재하므로 directed argument에 따라 directed graph, undirected graph의 adjacency matrix를 구성하는 부분.</span>.</li>
                            <li>28번째 줄: Adjacency matrix를 39 ~ 52번째 줄의 함수를 이용하여 normalization 하는 부분.</li>
                            <li>31번째 줄: Node feature matrix를 39 ~ 52번째 줄의 함수를 이용하여 normalization 하는 부분.</li>
                            <li>34번째 줄: Node별 label을 구성하는 부분.</li>
                            <li>39 ~ 52번째 줄: Matrix normalization 하는 부분.</li>
                            <li>44 ~ 47번째 줄: Matrix를 \(D^{-\frac{1}{2}}AD^{-\frac{1}{2}}\)로 normalization 하는 부분.</li>
                            <li>38 ~ 51번째 줄: Matrix를 \(D^{-1}A\)로 normalization 하는 부분.</li>
                        </ul>
                    </p>



                    <div class="doubleSubHead">
                        <span style="display: block; text-align: center; margin-top: 150px;">&ldquo;</span>
                        <span>GCN 모델 구성</span><br>
                        <span style="display: block; text-align: center; margin-top: 13px;">&rdquo;</span>
                    </div>
                    <p>
                        여기서는 학습에 사용할 GCN 모듈과 모델을 구성하는 코드입니다.
                </p>
<pre><code class="python"><span class="reserved">class</span> <span class="clazz">GraphConv</span>(<span class="clazz">nn</span>.<span class="clazz">Module</span>):
    <span class="reserved">def</span> <span class="method">__init__</span>(<span class="var">self</span>, <span class="var">in_size</span>, <span class="var">out_size</span>, <span class="var">dropout</span>=<span class="reserved">None</span>, <span class="var">activation</span>=<span class="reserved">False</span>):
        <span class="clazz">super</span>(<span class="clazz">GraphConv</span>, <span class="var">self</span>).<span class="method">__init__</span>()
        <span class="var">self</span>.<span class="var">in_size</span> = <span class="var">in_size</span>
        <span class="var">self</span>.<span class="var">out_size</span> = <span class="var">out_size</span>
        <span class="var">self</span>.<span class="var">dropout</span> = <span class="var">dropout</span>
        <span class="var">self</span>.<span class="var">activation</span> = <span class="var">activation</span>
        
        <span class="var">self</span>.<span class="var">layer</span> = <span class="clazz">nn</span>.<span class="clazz">Linear</span>(<span class="var">self</span>.<span class="var">in_size</span>, <span class="var">self</span>.<span class="var">out_size</span>)
        <span class="return">if</span> <span class="reserved">not</span> <span class="var">self</span>.<span class="var">dropout</span> == <span class="reserved">None</span>:
            <span class="var">self</span>.<span class="var"><span class="var"><span class="var">dropout</span>_<span class="var">layer</span></span></span> = <span class="clazz">nn</span>.<span class="clazz">Dropout</span>(<span class="var">self</span>.<span class="var">dropout</span>)
        <span class="return">if</span> <span class="var">self</span>.<span class="var">activation</span>:
            <span class="var">self</span>.<span class="var">relu</span> = <span class="clazz">nn</span>.<span class="clazz">ReLU</span>()

        <span class="var">self</span>.<span class="method">init_wts</span>()


    <span class="reserved">def</span> <span class="method">init_wts</span>(<span class="var">self</span>):
        <span class="return">for</span> <span class="var">m</span> <span class="return">in</span> <span class="var">self</span>.<span class="method">modules</span>():
            <span class="return">if</span> <span class="method">isinstance</span>(<span class="var">m</span>, <span class="clazz">nn</span>.<span class="clazz">Linear</span>):
                <span class="var">stdv</span> = <span class="num">1</span>/<span class="var">m</span>.<span class="var">weight</span>.size(<span class="num">1</span>)
                <span class="clazz">nn</span>.<span class="clazz">init</span>.<span class="method">uniform_</span>(<span class="var"></span>.<span class="var">weight</span>, -<span class="var">stdv</span>, <span class="var">stdv</span>)


    <span class="reserved">def</span> <span class="method">forward</span>(<span class="var">self</span>, <span class="var">adj</span>, <span class="var">x</span>):
        <span class="var">x</span> = <span class="clazz">torch</span>.<span class="method">mm</span>(<span class="var">adj</span>, <span class="var">self</span>.<span class="var">layer</span>(<span class="var">x</span>))
        <span class="return">if</span> <span class="var">self</span>.<span class="var">activation</span>:
            <span class="var">x</span> = <span class="var">self</span>.<span class="var">relu</span>(<span class="var">x</span>)
        <span class="return">if</span> <span class="reserved">not</span> <span class="var">self</span>.<span class="var">dropout</span> == <span class="reserved">None</span>:
            <span class="var">x</span> = <span class="var">self</span>.<span class="var"><span class="var"><span class="var">dropout</span>_<span class="var">layer</span></span></span>(<span class="var">x</span>)
        <span class="return">return</span> <span class="var">x</span>



<span class="reserved">class</span> <span class="clazz">GCN</span>(<span class="clazz">nn</span>.<span class="clazz">Module</span>):
    <span class="reserved">def</span> <span class="method">__init__</span>(<span class="var">self</span>, <span class="var">config</span>, <span class="var">input_dim</span>, <span class="var">class_num</span>):
        <span class="clazz">super</span>(<span class="clazz">GCN</span>, <span class="var">self</span>).<span class="method">__init__</span>()
        <span class="var">self</span>.<span class="var">hidden_dim</span> = <span class="var">config</span>.<span class="var">hidden_dim</span>
        <span class="var">self</span>.<span class="var">dropout</span> = <span class="var">config</span>.<span class="var">dropout</span>
        <span class="var">self</span>.<span class="var">input_dim</span> = <span class="var">input_dim</span>
        <span class="var">self</span>.<span class="var">class_num</span> = <span class="var">class_num</span>
        
        <span class="var">self</span>.<span class="var">gc1</span> = <span class="var">self</span>.<span class="method">get_layers</span>(<span class="var">self</span>.<span class="var">input_dim</span>, <span class="var">self</span>.<span class="var">hidden_dim</span>, <span class="reserved">True</span>, <span class="reserved">True</span>)
        <span class="var">self</span>.<span class="var">gc2</span> = <span class="var">self</span>.<span class="method">get_layers</span>(<span class="var">self</span>.<span class="var">hidden_dim</span>, <span class="var">self</span>.<span class="var">class_num</span>, <span class="reserved">False</span>, <span class="reserved">False</span>)


    <span class="reserved">def</span> <span class="method">get_layers</span>(<span class="var">self</span>, <span class="var">in_size</span>, <span class="var">out_size</span>, <span class="var">activation</span>=<span class="reserved">False</span>, <span class="var">dropout</span>=<span class="reserved">False</span>):
        <span class="return">if</span> <span class="var">dropout</span>:
            <span class="var"><span class="var">layer</span>_list</span> = [<span class="clazz">GraphConv</span>(<span class="var">in_size</span>, <span class="var">out_size</span>, <span class="var">self</span>.<span class="var">dropout</span>, <span class="var">activation</span>)]
        <span class="return">else</span>:
            <span class="var"><span class="var">layer</span>_list</span> = [<span class="clazz">GraphConv</span>(<span class="var">in_size</span>, <span class="var">out_size</span>, <span class="reserved">None</span>, <span class="var">activation</span>)]
        <span class="var"><span class="var">layer</span>_list</span> = <span class="clazz">nn</span>.<span class="clazz"><span class="clazz">Module</span>List</span>(<span class="var"><span class="var">layer</span>_list</span>)
        <span class="return">return</span> <span class="var"><span class="var">layer</span>_list</span>
    

    <span class="reserved">def</span> <span class="method">forward</span>(<span class="var">self</span>, <span class="var">adj</span>, <span class="var">x</span>):
        <span class="return">for</span> <span class="var">l</span> <span class="return">in</span> <span class="var">self</span>.<span class="var">gc1</span>:
            <span class="var">x</span> = <span class="var">l</span>(<span class="var">adj</span>, <span class="var">x</span>)

        <span class="return">for</span> <span class="var">l</span> <span class="return">in</span> <span class="var">self</span>.<span class="var">gc2</span>:
            <span class="var">x</span> = <span class="var">l</span>(<span class="var">adj</span>, <span class="var">x</span>)

        <span class="return">return</span> <span class="var">x</span>
</code></pre>

                    <p>
                        <ul>
                            <li>1 ~ 31번째 줄: Graph Convolution 모듈 구성하는 부분.</li>
                            <li>35 ~ 63번째 줄: 모듈을 불러 하나의 모델로 구성하는 부분.</li>
                            <li>57 ~ 58, 60 ~ 61번째 줄: <span class="highlight" style="color: rgb(0, 3, 206);"><span class="clazz">nn</span>.<span class="clazz">Sequential</span>은 인자를 하나만 받을 수 있기 때문에 <span class="clazz">nn</span>.<span class="clazz">ModulList</span>로 구성.</span></li>
                        </ul>

                    </p>


                    <div class="doubleSubHead">
                        <span style="display: block; text-align: center; margin-top: 150px;">&ldquo;</span>
                        <span>GCN 학습</span><br>
                        <span style="display: block; text-align: center; margin-top: 13px;">&rdquo;</span>
                    </div>
                    
                    <p>
                        이제는 구성한 GCN 모델을 바탕으로 코드를 학습하는 부분입니다.
                        아래 코드에 <span style="color:rgb(86, 155, 214);">self</span>. 이라고 나와있는 부분은 GitHub 코드에 보면 알겠지만 학습하는 코드가 class 내부의 변수이기 때문에 있는 것입니다.
                        여기서는 무시해도 좋습니다.
                        <br><br>그리고 아래 학습 코드는 실제 학습 코드를 간소화한 것입니다. Scheduler 등 전체 학습 코드는 <a href="https://github.com/ljm565/paper-category-prediction-GCN" target="_blank"><span class="highlight" style="color: rgb(0, 3, 206);">GitHub 코드</span></a>를 참고하면 됩니다.
                    </p>


<pre><code class="python"><span class="var">self</span>.<span class="var">model</span> = <span class="clazz">GCN</span>(<span class="var">self</span>.<span class="var">config</span>, <span class="var">input_dim</span>, <span class="var">class_num</span>).<span class="method">to</span>(<span class="var">self</span>.<span class="var">device</span>)
<span class="var">self</span>.<span class="var">criterion</span> = <span class="clazz">nn</span>.<span class="clazz">CrossEntropyLoss</span>()
<span class="var">self</span>.<span class="var">optimizer</span> = <span class="clazz">optim</span>.<span class="clazz">Adam</span>(<span class="var">self</span>.<span class="var">model</span>.<span class="method">parameters</span>(), <span class="var">lr</span>=<span class="var">self</span>.<span class="var">lr</span>)

<span class="var">idx_dict</span> = {<span class="str">'train'</span>: <span class="var">self</span>.<span class="var">train_idx</span>, <span class="str">'val'</span>: <span class="var">self</span>.<span class="var">val_idx</span>, <span class="str">'test'</span>: <span class="var">self</span>.<span class="var">test_idx</span>}
<span class="return">for</span> <span class="var">epoch</span> <span class="return">in</span> <span class="clazz">range</span>(<span class="var">self</span>.<span class="var">epochs</span>):
    <span class="return">for</span> <span class="var">phase</span> <span class="return">in</span> [<span class="str">'train'</span>, <span class="str">'val'</span>]:
        <span class="var">idx</span> = <span class="var">idx_dict</span>[<span class="var">phase</span>]
        <span class="return">if</span> <span class="var">phase</span> == <span class="str">'train'</span>:
            <span class="var">self</span>.<span class="var">model</span>.<span class="method">train</span>()
        <span class="return">else</span>:
            <span class="var">self</span>.<span class="var">model</span>.<span class="method">eval</span>()

        <span class="var">self</span>.<span class="var">optimizer</span>.<span class="method">zero_grad</span>()

        <span class="return">with</span> <span class="clazz">torch</span>.<span class="clazz">set_grad_enabled</span>(<span class="var">phase</span>==<span class="str">'train'</span>):
            <span class="var">adj</span>, <span class="var">feature</span>, <span class="var">label</span> = <span class="var">self</span>.<span class="var">adj</span>.<span class="method">to</span>(<span class="var">self</span>.<span class="var">device</span>), <span class="var">self</span>.<span class="var">feature</span>.<span class="method">to</span>(<span class="var">self</span>.<span class="var">device</span>), <span class="var">self</span>.<span class="var">label</span>.<span class="method">to</span>(<span class="var">self</span>.<span class="var">device</span>)
            <span class="var">output</span> = <span class="var">self</span>.<span class="var">model</span>(<span class="var">adj</span>, <span class="var">feature</span>)
            <span class="var">loss</span> = <span class="var">self</span>.<span class="var">criterion</span>(<span class="var">output</span>[<span class="var">idx</span>], <span class="var">label</span>[<span class="var">idx</span>])

            <span class="return">if</span> <span class="var">phase</span> == <span class="str">'train'</span>:
                <span class="var">loss</span>.backward()
                <span class="var">self</span>.<span class="var">optimizer</span>.<span class="method">step</span>()
</code></pre>

                    <p>
                        <span style="font-size: 20px;"><b>학습에 필요한 것들 선언</b></span>
                        <br>먼저 위에 코드에서 정의한 모델을 불러오고 학습에 필요한 loss function, optimizer 등을 선언하는 부분입니다.
                        <ul>
                            <li>1 ~ 3번째 줄: Loss function, 모델 및 optimizer 선언.</li>
                        </ul>

                        <br><span style="font-size: 20px;"><b>모델 학습</b></span>
                        <ul>
                            <li>5 ~ 23번째 줄: Cross entropy loss를 이용하여 모델 학습하는 부분.</li>
                            <li>5번째 줄: Train, validation, test에 사용할 node의 index를 저장해놓은 부분.</li>
                            <li>19번째 줄: <span class="highlight" style="color: rgb(0, 3, 206);">모델을 업데이트하거나 loss를 계산할 때 train에 사용될 node만 사용하여 업데이트 하는 부분.</span></li>
                        </ul>
                    </p>




                    <div class="doubleSubHead">
                        <span style="display: block; text-align: center; margin-top: 150px;">&ldquo;</span>
                        <span>학습 결과 및 특징 가시화</span><br>
                        <span style="display: block; text-align: center; margin-top: 13px;">&rdquo;</span>
                    </div>
                    <p>
                        이제 directed, undirected로 구성한 그래프의 학습 결과를 살펴보겠습니다.
                        두 경우 모두 dynamic normalization을 사용하였습니다(\(D^{-\frac{1}{2}}AD^{-\frac{1}{2}}\)로 normalization).
                        
                        <br><br><span style="font-size: 20px;"><b>Directed Graph Loss History</b></span>
                    </p>
                    <div class="contentImg">
                        <img src="https://lh3.googleusercontent.com/fife/ALs6j_Ev-5dJipQwWHJ0l8XjADZmoRBxVgZLgoZPmMtiHNQuI1m_jobgRX09tPYmS020Ua5WnA5jbObNlV2DVPzTtsz-altmRc2R1DCmX1h3aVeNYFJAM0EkEjnjpmXK5d9XIZAVQtMJaWHnEhMQIDu9fojOa5rEnETpwUmQSJgzLZogpWnq6bCzWeBkJJbUMF_fxczp4UYYJLgp6KYhKgxILb0ok07bFTgDH5CRNAjAEUYXhEIWoF3ab92-YRhBtpyOeVkn_NL9D3At6UwIUfmKLo3H5b2jsDYMCxDfeF00MKZOdufunHDCHXoot_lFsfephx8nj1XPRxaFRFVrayKx-0oQK_hq-Zgm8XiRWib_rWp4Hc11vc3rtEwskJ2d4rwgRXEZSJto56XPmZKSAOxpW7rBb5Nw9j339KZUZDU9Rr4xZh3P5kGxcDODbw3uaQyTk6Ws9ZYSHa9xgDrTes1lNuceK48cT4uUbXhbsFBGX3QFgcRx09cmaSuyJYcOWvx1Up9GhBANedMgN9v0ZLRTedrTDFIwGshe1-60Lywu0DMH2l6v0DbB-5pF8GBUplEWfSiMVvrlDjY7lBn1Q_5gHQmBskgzWILN5DlJd_FErUbmocJv9kSGMpvBlSHs0p8ZbiMsoO6z4BwrdqqntabEUztILAhKhCjL8JpH7wyRXe-X9bfVsSj1RdO2nsXJAD3f8-mLLklGXLOv2qws6rzuYFStl2YMBU1RLIcVxXmhKJMLjvmag6hoguemvacyQ00-hFmcu6s4whcn_XwzLR8RGrdRhKODfczoxlNBVujonwhc25Zphniky4L1NwZ2Ngld-hoe3vOKjoc9_1As5uTDzd2zNhkKey0gge8RLG3jECTghsD1DmkmQKPHt0lvXtvaGk9ej1GzGnnoA8z3yXg5_Rt79AH3U74S5EMnPzwaYZ6z3u4QIv1UiSCHMsZRG5fioCG_BUEfkK4bOguu3cSXYNzzJmnCRr3IzNpRjgNt8PG5eFBJphrCwdEHVCq5dDTTYzrShysJ1zBqhXvDwArvfF-kXEjXaX2NQ6OBKeVx558WJFPhETVVJeSwE2ri-fGXkVCId33C5mMMuGcOef_s3Ju70od_nZYP1jsfQdJvBA7qyfMOAg8iusWrbTnC3zYtgtd8nIQ7zvXspx79E8sLRnIHwC6b6Z5evRcBVyXqJaGZa6NcFWKNxTGMjD9cSxZCoAKQ8QPLcbt2KM1ecsXDbMS8krE0kjo2YFDf6JlgKVDDa38yocOBU9t6kt8qmwG8PaUKb8hiWI1ey-wM2f2AXlwIsLozG-IPGyosxrRe2UgFTERDxFTjFfK9ivj6SgH-_x6IQmbQQC8D-upi4w6h2sVrgLBicfRgYqhInarvwL6G1T-5cC62CaDLMESNTjIjHd0LyaPa-p_0MjXLj5wm7zNWMX2he8qVbQs9lofF6qqDFUtk7wl-CwLKDJnJnziSPoenTDrT9BQMu5VJJ2FRSxCLUoGEYSeVvMe-n72fs3mDmqZxDOGtUpgDvKONtlfBcqjR2XCiSyuD" style="width: 100%;">
                        <p class="caption">Directed graph loss history</p>
                    </div>
                    
                    <p>
                        <br><span style="font-size: 20px;"><b>Directed Graph Accuracy History</b></span>
                    </p>
                    <div class="contentImg">
                        <img src="https://lh3.googleusercontent.com/fife/ALs6j_EGKbLdfqXRJhCMa7IoR-lKl1aM0Oug_yv6n40hSQt5JHtpWisocyc5kWMPur4zAVOfL35QhDujefO7LlCBDxCLiX0OrECpRtYYr8WhYY2WkBlwI003dUMdC0tZ7ZMvXLpfvk9rebFTSWfSqqkzsvb4LKNs-5-JcF7nvyMDuKkfmXVCzVjmmnKJqjhUGEopewrI3eOU9Llbh_xbUntkkuBMRP3XDHDBGwpWymlIuPA-qbafepiBlnmj7lEeGvWynRYvEfl7OyHiVP5tAulQX2IRTUksIk6WdHuXVNVyMJQ9K-ZJEzzWUkW1gUuOurlwaiuKYOfA6ZX5UOLwgwm-nSJQMm1iZ2WKs8GyW7hlRCHmJG2gtDQ1FTpDY6oqPIiHcLVMhcONX9DmnpKlumV9gGdFTnaRveJXDCpk9xhTv8OIsH4-4QM0EFmsps8VvqCR_VceMvUX7qeZlWb9FhzD25YqHXXax9_6lvMs86SDBElknDnp9OoNhJkIkHqiW_vFkCZD2f2ndiZ0Ad-g3Eb0TQhARbOWnPzXQZEyEsidjXxskWHEmqzVSgNCM4-Y7uUMeVf0rAJ9MgcLnkifejQEoHAp7fFhQcVi6XBkji3_PHrrQ3ZOWeXFp-AJPDsYxUVUAA7xMJib0LPK783buY_js25roRdObx7muvpcAu2upFm2JekrH-N4KpPk1zs2otaSq56vuOcjGX6toZ4LUvVbqwvGAQRoAzk_2fGMijg5H0__ha-fw29FtAXarhBAj9bXLbE4_Oy46cnreEChN9UoeeV_gbi7wBIs3AxQ0RzD_UeW0oCfjWKV7jRBgo24QcUezJe0rTV_k0fHMI-t1qPoVAz_YwNUH414flsQtPwDWv5d2m7G4rdf_7JrO6xOB9Fcxts3Oazt7YJrWJVggf7p6P9PM8gsB6etBMVRRS38Q0FL-9mj2P9o_Kt1cuky77jcFcbMYq1c0jW_7Libda7qufs0u5xqOGG_ApImM2wo8Yu2UJDMVfbmozKSWc34m2ty00XGzpujM5tftZ7Pmf5C-x6pKJK1Psou6fd3TcRhFJY-6YlQTqPYfSX_Zy0eDoqvvMflk5vqN1VmNCm-qIjWRPVYkeZdYW5WgTbYMmQKbTqyuXILehpazCySeP6XtvxBoA8H5bcaTAg3lP4yvC5CdTNJ8CMF9Sgsab5E3DCoqPnbxK7mn2lzEpIee6H0VTTk_1083txb-KLbi97HKG6rjLeK-jzVPBHbaZKfqnBGTRFX1kvtsyg-wUpb_wgBLAm4jq1GHSUzhst8ohXybyi0QWyGaG2Ri1KM2R_x2rZhwwCa2OtuV-WCwya1R1XCrWiKOjGKWl9ffXyUUYMSJ8wasfmU2cH4K4RgyVglT3t_P2fOXdnaVjzo-zLW9ysXH-5aA78wP4GHGDAyKavzvhlJ71yodHWjc3f7kZ6-znQo9lpvGv7gYRxOKjupSsAnTKIZKVYH0Qnr6ZmEKz08T1EpFoeSg9ZaOOlqRfMWnzy5i7RJ6oAp3VNXcxuh7WHb-KVutPDRCgfEbEhS" style="width: 100%;">
                        <p class="caption">Directed graph accuracy history</p>
                    </div>
                    
                    <p>
                        <br>아래 결과는 validation set의 가장 높은 accuracy를 달성했을 때 모델의 test set 결과입니다.
                        <ul>
                            <li>Accuracy: 0.8600</li>
                        </ul>


                        <br><br><span style="font-size: 20px;"><b>Directed Graph Feature Visualization</b></span>
                        <br>아래는 test set의 실제 label과 예측한 label을 바탕으로 학습된 node의 특징을 t-SNE로 가시화한 그림입니다.
                    </p>
                    <div class="contentImg">
                        <img src="https://lh3.googleusercontent.com/fife/ALs6j_E_NNjB34BDMdT11HX3QnmIeYAv1i-_WAa2cS0u9oj5ZKolhrNwaGMxTDhUR9-f19uGyALRMWp9crmMjJ7ZciEqCT0hzkIV2COu4Eo4Bgsm1AjvMAWwGMcfOrCQwPmlByDQRfcDPseFnwAiItZDad_JajR7cQ7dFlFLGUuApaOZbysSqlZrrGr8qoh0v2Sq4Yhws1lz-yRO7-vDRJaDNV8mNxOmtMwgJPXkoMZIkgyXW9l5lvoZ9qrrbwQrZHahcSlqOVaqmOWDRpVvB0aEUIykl_F93SPrYHHKil_GRP660I-7C8Ej2MiFcjfpOFuB8cBQ8MKzvwgd_nKidXMFodyN3V8QGm2qXxEfxMS-_dVpdCUVONiaub5SnFW-vS_ndJ2i7PqynkiH2ZBzj8mKSs71QPgSDZji_QeY1ykrgrjE_lVcPxvQa9YuPf0ut3UNEp6y24Nuago2SlCDP7Klmx3KsknHe_q-NCuFM0GxEf2iAukMxXfBR4zvrptHWbWy4KytzgtjMM-rtWbfOD3jBlkP6dfABQBy7SRR0v6sy4ilAQGjONVK-8PFDPO88Gg8jqO5jyUhcuTRDPHf2k2zGP_iYgrhMprCgXHkkcpTXjCXi9XvLb9pKiAP70zrh4Sjic2Ly5NIWEgINdVaw711jn4Rbk9aIZGl0krUhXjK6wYqq0CP_Yx6abW16dntwIqMmDbj2QB8Z9rwWq_fb16dl1aNJR5rkglZcQfSeroG46CRBqfTkDJrT0V7V4k8w0gS-YsdBB2uaKNN3yp36BkcElJsWESeLNLxzvyBtp0CdAin13wV7bdnRDoFzXcJ9_OaTaJgWYdhYbgoPEOarFB0rIHquy_MGjr-N7JG1_0YxzpojFSrgyZIUhrVb1YQBJ7p1r-5M50PuXHnEDyD4pchW_0kvt-VsnFnhHY3SDMYqfVijWMSb825bwxVb7ttY9bKTfi6H_zyXMoohG8vejHCoqxuFWnp_W9mqFQzTjM6NakTlnuOlsJ1kYp4rGhatu35idK7ihlxxkypSQG-486ymXTA4Xw-pXQPCN7RqNiBwss6FXrAiGZgA-gTInsw4JNYTHb9kZdZTXTyfG53giBpso9hb_w-sy5hbndp6k7NvMFoS0MvePnLORr7stI-3FhBe2dvKlMIgyMdQIkUr3RdYDcyovWc9gOcq4WbPB6OJx4mru88NhfMlN8VrytT-Hfn92_otaYVGmqInOLefULWW6n2TTwtuP8vjnv7GmAHyw7duZBagkyhuTjqGEv_IwXn3WmeF5l_Rmg88HKVl2P3h0q-Sp-gnlgfwcv1zpZCIxkRyE1sQrZwMe-2CQhXzW3auIn_7apRRBvkexEsqt8Rvx1tZ-H9ToYMx7lPABUlOrlM2TRPLDT_2FhCkU2dArgO6TypOjdL2T180LewwYVYJu9Nszu_cH2o31WmKqRhaKqGWkNCEGivGgvGc41MIoC0WFf9bpqfnHhod61GQsfka-9sRpzXLcd9ekUBCjwEBHsyZX8Cv12zyKTm2xF5Ngx-otEp9cygyZ0D" style="width: 100%;">
                        <p class="caption">Directed node feature visualization</p>
                    </div>

                    <p>
                        <br><br><br><br><br><span style="font-size: 20px;"><b>Undirected Graph Loss History</b></span>
                    </p> 
                    
                    
                                            
                    
                    <div class="contentImg">
                        <img src="https://lh3.googleusercontent.com/fife/ALs6j_FWSBrCMQgCdcLwwHDKo_WQlFJUCIiwt9AYm_hWCJkEm_Nx2MtUVZniCB9ZOTSJPhyE6pn36kYhx70RM8U82wV2QVhbvviuYAMk32oruI65D0MkS2_JxMLysTTx2Ig8LodioyGFphkNoeLOxx06PKhgMjWjGKNHfCZq_CRtjphBjgjivLg9TvHMn178lCacN3PQwME1BA_j9tJaB2lntTvBPc3gzutmufNXP39_80z-IViXgli_yiBcTyjeEMDVvmMC077PXwwuljkxviavzHvnhFIQl4hhLfahikZ_0O-AG_h72i2emohbRDAjLanBiaM4NUySrN06VmbERd4NSNASDo7MrutJLkyRr2BMkyg3QFMvYH1T4Pz348rmvj-jmG5bsV6t-NiRerH5HrOvxU3uADWMZLfpOD-7__1e5sBN3cW4Um-DpzO6yV6JziPa5gVji0t1rjRoFFzkDvix17pKXoBw6gDaMZpbap2tFsTZU8SlyQt-EgKOsNHnhZQhYGmR0ejM8FqWHA8sOvMk4nl4E-omgJC5lt8BzJ8EZ0Zi9VsEKKHVgd1JQ31QJwnfSpoEgO4Usqm2JAxYUUqfIHe7jnCgGz4TBzj2EmDM4X0vvVIU7WuwUFXRK7uHRpOGcwXsqFzE6SK4EHqNjZbbCXN15iuK7NPdHTfwpUJrUuFU6G7SZC99sIGRngM_RkM9DKLkD7oLJ4xCgoF6FToxp25tEHc63-96EonujIwJLZ6xuxLRIhrvfLaEW851cmCB0zOqGg31StQ6Sk3XUhUFfOgrxqExJddOKwBr-xYhj8sKA4TCVlSTmLwQgZcBcEVGlRF0zp3TXXEoDtUC1FhRhv-j2DkKh5fSEDTX-o6Hq1kN0k9eJiklpflocNMNIzg1IcJcjJ77Cfp4wdVoV4Vzxb_FLEZXQAuuJL89HygqIsTzbgzjazfOKWKAFK316QG0QOjMp4joHtpExh_zFS8ji5BlYncQM2_WTPzuMKICFnO0arsxZaf1kdvbwcLGJ54DD-E4mdf3Bbuzk1yz8GNTkrjGp423QE7LODbEyvXvi2yyDN-bfPrW_WJ9I_BMCDCu7Fi17q34NbGSxwvqp5o2G9vgDoNfxIbAZ8tNJ4f0Ww4fW2jq7FeAcy6Eye_rZR4U7a6sRuxqcBoGXzLvtkPuV8XpwldqlIuBHTuyAG5EV3jEjuHteXnWZAUUN2x-W3vRQ57-bV1HH2FAsq__bpcROcLRuOckxLsqIt4R2D7jtKr90Gs7R4k6kCGZDUbPy1dA_0-T4Xck2TyM7F7c42ig9aIFnLQPBP98sjvaNdOKNuOr4zdow_TMa6qYgZp44OgAC0Shva4uH5ZTm6VaHApyx0DuEm8MHpW6x7bNhMM5FUNrS1jYsqHp7utj7veTgjlnosuewFG5rOk2YWNscafSD4rbMXrPpLk2vUgaHh_Qth2dD0e5H6dilIrRsQfNdeWY51GnnBAhxoUruEGgeB3c3gWCIypV30FCmaXNFoQFEmsrle-TMCcdNRIiLnIL0jJuhv5je2eoK-Yh" style="width: 100%;">
                        <p class="caption">Undirected graph loss history</p>
                    </div>
                    
                    <p>
                        <br><span style="font-size: 20px;"><b>Undirected Graph Accuracy History</b></span>
                    </p>
                    <div class="contentImg">
                        <img src="https://lh3.googleusercontent.com/fife/ALs6j_FN_GiFn_b0opHBrgelt1mlFazt3sm2iRUDWRFTItUOoG6Vk4oPYLA3oJZZrYVHE32DbpJpC3oN7ZzWqWZeClsi2457NaOR_6BGCGM1SQdbxgWBUbmvoPS18TX2xvBNes9xN1g2xip40v6yEcKJ680OPipUY-gSrraWodNmuMfZxbaRpAy8VeOXF_mcj3FrstMOMnil5s3dWmozUYDOrmqXLAe5yw2yu0YSOphbgY737U1KvE2xZDvmsCooi8U3OmwzeVA-dEgLUFJ0OgP9D-I5Zknm0thNfYgZeol3fNwHc6mCRlXeyeGHgcmXeh0A1194R1wBvtA6e1j4VrNX-OxFOAfMruR5DmjnUKwaPDI15JGfzhi7Ngg85Zr48QMhGq5EIKCT1_kS0jhHJ3dhB8SazHihUrngq2XE5dClx5xVm9hj2V1kewwQzqYFvwev-YLC1VddPQvfJivF3-aIQZPSqpdp8RMw8rdifpx1fAoPT6Hv3obmUAZKQc20CAv5W3218wRoHblWXw_oXapWLm7Se9p8_rrDJWTV8FQZPMRfMT3BxrlgbCzH07pd-CWbiH-LuYmRNSX9jTFAKkXL8syzTvU527mQpnYiTddVTTNZJXmZFPYHs-0rOmowgIfO48O6TScctQJK4wzzBZok4hkGkRPnfBrrgR2g3NFz_1lQhofh3nHu_UgjsasfaF7cL8Wmr2X0BGgmWBu30AWQgxZfEIt8ypTCG_OKYrTtBfpIOqwgPmJsGaYjb1vbz4GXovLUeG-J-6261VgxATPopH-qn-MhSG4IPjkmOBaY_O3p4ke7cIfNL6FoMC4GvqPC__z5bTOSJl6wrDnAMfYhir-ePh7-e_ZYKgon5EDMFotX6AtUJRmjJteFbOBoVl47BtkXRbZTcCDw8rsyi9a1BycnJjs-ftod8lKPA4LQyJPZ6I5wQmZqwo67-ykBoOv8OTjie2jv9iUghgLGQGaFR3KAptA3DsCpuNMgF89tEsMGw5HzLZyhv-zEfMs2axJKD_uU8hea9UoyU-UCXBXwbfsK67lfaeegrwBmadtML_6-YSyI1-u7RHZxpw_gLcJ-2apyU4W__jWW8bJMcgvsDteAFiP82H0t5G_S_la02-LnowjbVuHCNQ8wxzND0TPayW7cBXScVR81Fn42LOUflDLRJ48tNqSUy9hxFI0pTS531LmKLfiKsuQT0GXSMQW5irAF8-lsxNvQtnSqjC-ytp6PnAZnIsyHCz5tsMxkVle34Gq0FKJoFeqOAU2iC75IlJNakmK22XlA7NvKKRHtuwoE7Xb_M7w9fgm9kXs498ewhmkbQxwdKCrgDuJKt-XiPJQgAJSfrCbEMNAMcZZTp38IoILtrBGEXIVNyLkcOsNpMi44pn0eSLAbnRfz24yiQCHgwSB8458GPil0mZbFqA6eS0E4_vY3u9na-F-lX9-9MtqZ2diKWPY7ikvs1xz8U9Dy1MmI9ToAD7uR_xvMlPorRC-jMtQ6na8gUoBiLOcITUkCem2QmEbl6ceYggEdmPRZ5uy9Q1Tu" style="width: 100%;">
                        <p class="caption">Undirected graph accuracy history</p>
                    </div>
                    
                    <p>
                        <br>아래 결과는 validation set의 가장 높은 accuracy를 달성했을 때 모델의 test set 결과입니다.
                        <ul>
                            <li>Accuracy: 0.8771</li>
                        </ul>

                        <br><br><span style="font-size: 20px;"><b>Undirected Graph Feature Visualization</b></span>
                        <br>아래는 test set의 실제 label과 예측한 label을 바탕으로 학습된 node의 특징을 t-SNE로 가시화한 그림입니다.
                    </p>  
                    <div class="contentImg">
                        <img src="https://lh3.googleusercontent.com/fife/ALs6j_EiXg856tl-UUdNbHNXG838z4ZFH-5RDf7fi_rGUQNTuqxqmijYhdNO_jc6PpDc-I1-E_o8MLbQ7XWY7Dd6FuaZafumzaiDW0Vz60R6qhJQl6-dyywrNS3UZ62s8g4eikRGjeUQB7xqHy_CUUkrNrnH6ShRaJE8Yw1hjSBjdYzcaoXCmAgkiBnfCmz_PpfoXYc2zqMdsJBfWVXpbFEHPcVFwGl_RQVAIc4GPNMTlwvsZ4dKN-k0veJfj4h1aJ6Wr-BJxHbpInDSRzhrXajoJ96I75ASuL7xCHPH0h7DapZ--DrjqF5LEJdZfiNItxxbjcRorIm_N5akg5uZWbkFAzMUITipKzYuDb0oSg30JP9EkF0odUgoBF2i4D0dQpeDkhaqs3MDZi3rhCBjXGSo5i7HwVSY0sCI02rh4TIDxrJbvuTz01Wo6_RTZDHZjqE40V27uKj7VqfPYpq0Ia9SGxQrGrVvB-oqKiLgBs7JEqtbMoBApA_ZdFPIhkITrcGweEbFE9jHVIVeh3IDrfz3aZbVd0NljwIxWgv9FkHZikvoNGuk8dJOHkZoK7ZDiMqd15HeuCTEzvFfQhkOlN6wV1wNBjskd1s55ulztDRRNvS-LLC3CZGVM0Hh0e2NCbLXnokZMDs4h6zA_pD2ZKK6d8OBUSgrDB2EnDW242-3j63UvRaeSkF_P8J6RNxc9-9n58ftuic2VO1twlSjCM1kENaP9cQg40sTeLAuW76l65si2_ofE-rQlwmrz4DYmV0Pb4Ju2Zz8owLXtiaCVCCGO_Ly3YVjI_e6ARAVy6lm6KGlJtIro1GzMnXusj6Zko_sSpR72dViC0td9dZrYORY4_QOeRIrMlw9gAyIIYgsJucd5oiF_RQepKlT1BK_XHKdcoWu07pL0uflTdyDh-zqFrERXGBTpQCrn4YIk8pz0GzCbyEDBPyzsN5Ba_rnnzCJjiqd_pYxziliaGDFEWSB1-RSrccp2s9K2oqFauEADqtn6tMNzjh99Z3zOrhheDKKc-X2LHi0cQ3m6NVXJIRcpmGZq3qkhRgiR9ekaGFYcihse59BZCx0lSN4RTQdDhZzon9xjyL3nKelE4NcN4mfPazAuNtmikmNJULhcr20o7iy5pd7i-4XADzZyx95tnSwmEej6ATBxW7FG1QS287msyu7LgVthbuVkpn4HsescCIXE6iXPZL0GgDCeipoPFL1ckIhamoJA-oDs_TCyoaXzIvzKvqn_YWeqvg-tXPDk83-_XHa6IYF3awmern3JUJIj_6_dxoTDGsqowPpjLI8qGmHHgSV6vq_784TQ_GO6a_1wKyqzRlFpan8X7S2fjsBKhij6hP5LItkQi0FFXoVNxEtI9LVCVcclx4f8_UxPGRvJEwnAT-45Lu-vTaA-YddyVU4kOY-ueA9gEZseCMr1CNZJbyoIKbz_EUDROYj3JfT0G9WatTrOJFN0GS0XMCJEPBZNKrvz74jWpzuyp2hIEMrkgHzV-W_q5xlMD4YJx4ZoOhoylQuPm_UvIVYrPSxSp9DKSlVCg" style="width: 100%;">
                        <p class="caption">Undirected node feature visualization</p>
                    </div>
                    
                    
                                       
                    <p>
                        <br><br><br>본 코드는 PyTorch Geometric 등의 라이브러리를 사용하지 않고 naive PyTorch만을 가지고 GCN을 구성한 코드입니다.
                        Cora 데이터가 크지 않기때문에 batch 학습이 불필요하여 이렇게 구성하였지만, 대부분의 데이터는 그 크기가 크기 때문에 batch 학습이 불가피합니다.
                        PyTorch Geometric을 이용한 코드는 <a onclick="pjaxPage('gnn3.html');"><span class="highlight" style="color: rgb(0, 3, 206);">다음글</span></a>을 참고하시기 바랍니다
                        
                        <br><br>학습 과정에 대한 전체 코드와 학습에 필요한 데이터는 <a href="https://github.com/ljm565/paper-category-prediction-GCN" target="_blank"><span class="highlight" style="color: rgb(0, 3, 206);">GitHub</span></a>에 있으니 참고하시면 될 것 같습니다.
                    </p>

                    
                </div> 
                <div class="tag">
                    <b>태그</b>&emsp;#GCN&emsp;#Cora&emsp;#GraphConvolutionalNetwork
                </div>
                <div class="pageTurner">
                    <div class="pageTurnerLeft">
                        <span><a style="position: absolute; left: 0;" onclick="pjaxPage('gnn1.html');" onmouseover="colorOn(this);" onmouseout="colorOff(this);">&lang; 이전글</a>
                        <br>Graph Neural Network (GNN), Graph Convolutional Network (GCN)</span>
                    </div>
                    <div class="pageTurnerRight">
                        <span><a style="position: absolute; right: 0;" onclick="pjaxPage('gnn3.html');" onmouseover="colorOn(this);" onmouseout="colorOff(this);">다음글 &rang;</a>
                        <br>GCN을 이용한 COLLAB TUDataset 그래프 분류</span>
                    </div>
                </div>
                <span id="readNum"></span>
                <div id="disqus_thread"></div>

                <script>
                    headHighlightColorChanger();
                    (function() { // DON'T EDIT BELOW THIS LINE
                    var d = document, s = d.createElement('script');
                    s.src = 'https://novicetraveler.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                    })(); 
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </article>
        </div>

        <div id="menuRelated">
            <div class="menuButton">
                <img id="menuImg" src="init/index_img/menu_black.png" onclick="openMenu(this);">
            </div>
            <div class="menu">
                <img id="menuExtension" title="메뉴를 확장합니다." src="init/index_img/extension_black.png" onclick="extendMenu(this);">
                <div class="profile">
                </div>
                <ul class="tree">
                </ul>
                <p class="copyrights">
                    © 2022. 여행 초짜. All rights reserved.
                </p>
            </div>
            <div class="bigMenu">
                <img id="menuCompression" title="메뉴를 축소합니다." src="init/index_img/compression_black.png" onclick="compressMenu(this);">
                <div class="profile">
                </div>
                <ul class="tree">
                </ul>
                <p class="copyrights">
                    © 2022. 여행 초짜. All rights reserved.
                </p>
            </div>
        </div>

        <script>
            detectScroll();
            pushFunc();
            detectSize();
        </script>
    </body>
</html>